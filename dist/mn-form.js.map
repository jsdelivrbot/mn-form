{"version":3,"sources":["scripts/mn-form.class.js"],"names":["MnForm","self","_this","_ret","_classCallCheck","this","setForm","_possibleConstructorReturn","validate","event","preventDefault","console","log","form","checkValidity","classList","add","putInForm","element","appendChild","getNameAndValue","attr","name","value","setAttribute","attribute","attributeSpec","attributeSpecs","filter","spec","isDefaultAttribute","hasOwnProperty","attributeValue","isValidValue","values","indexOf","default","_this2","remove","document","createElement","addEventListener","attributes","Array","from","map","defaultAttibutes","defaultAttr","some","instanceIndex","querySelectorAll","defaultFormName","getAttribute","concat","forEach","removeAttribute","children","cssClass","insertBefore","firstChild","HTMLElement","window","customElements","define"],"mappings":"sxCAAMA,OAAAA,SAAAA,cACJ,QAAAA,QAAYC,MAAM,GAAAC,OAAAC,IAGhB,OAHgBC,iBAAAC,KAAAL,QAChBC,KAAAA,MAAAA,2BAAAA,MAAAA,OAAAA,WAAAA,OAAAA,eAAAA,SAAAA,KAAAA,KAAaA,OACbC,MAAKI,UACLH,KAAOF,KAAPM,2BAAAL,MAAAC,iGAoCA,QAASK,UAASC,OAChBA,MAAMC,iBACNC,QAAQC,IAAI,YAAaC,KAAKC,iBAC9BD,KAAKE,UAAUC,IAAI,aAsCrB,QAASC,WAAUC,SACjBL,KAAKM,YAAYD,SAKnB,QAASE,iBAAgBC,MACvB,GAAMC,MAAOD,KAAKC,KACZC,MAAQF,KAAKE,KACnB,QAAQD,KAAAA,KAAMC,MAAAA,OAGhB,QAASC,cAAaC,WACpB,GAAMC,eAAgBC,eAAeC,OAAO,SAAAC,MAAA,MAAQA,MAAKP,OAASG,UAAUH,OAAM,EAClF,KAAKI,cACH,OAAO,CAET,IAAMI,oBAAqBJ,cAAcK,eAAe,WAClDC,eAAiBP,UAAUF,KAEjC,IAAIO,mBAAoB,CACtB,GAAMG,cAAeP,cAAcK,eAAe,WAC7CL,cAAcQ,OAAOC,QAAQH,iBAAmB,EAE/CT,MAAQU,aACVD,eACAN,cAAcU,OAElBvB,MAAKW,aAAaC,UAAUH,KAAMC,WACzBS,iBACTnB,KAAKW,aAAaC,UAAUH,KAAMU,gBAxG9B,GAAAK,QAAAhC,KACFsB,iBAEFL,KAAM,aACNc,QAAS,QACTF,QACE,OACA,WAIFZ,KAAM,SAGNA,KAAM,aACNc,QAAS,SAGTd,KAAM,aAGNA,KAAM,mBAGNA,KAAM,KACNgB,QAAQ,IAINzB,KAAO0B,SAASC,cAAc,OAEpC3B,MAAK4B,iBAAiB,SAAUjC,SAQhC,IAAMkC,YAAaC,MAChBC,KAAKvC,KAAKqC,YACVG,IAAIzB,iBAED0B,iBAAmBnB,eACtBC,OAAO,SAAAP,MAAA,MAAQA,MAAKU,eAAe,aACnCH,OAAO,SAAAmB,aAAA,OAAgBL,WAAWM,KAAK,SAAAvB,WAAA,MAAaA,WAAUH,OAASyB,YAAYzB,SAEhF2B,cAAgBN,MAAMC,KAAKL,SAASW,iBAAiB,YAAYf,QAAQ9B,MACzE8C,gBAAAA,QAAyBF,cAAgB,EAAIA,cAAgB,GAEnEpC,MAAKW,aAAa,OAAQnB,KAAK+C,aAAa,SAAWD,iBAEvDT,WAAWW,OAAOP,kBAAkBQ,QAAQ9B,cAE5CG,eACGC,OAAO,SAAAP,MAAA,MAAQA,MAAKiB,SACpBgB,QAAQ,SAAAjC,MACPgB,OAAKkB,gBAAgBlC,KAAKC,QAG9BqB,MACGC,KAAKvC,KAAKmD,UACVF,QAAQrC,WAEX0B,MACGC,KAAKvC,KAAKU,WACVuC,QAAQ,SAAAG,UACPpB,OAAKtB,UAAUuB,OAAOmB,UACtB5C,KAAKE,UAAUC,IAAIyC,YAGvBpD,KAAKkD,gBAAgB,SACrBlD,KAAKkD,gBAAgB,QAMrBlD,KAAKqD,aAAa7C,KAAMR,KAAKsD,wBArFZC,YAqHrBC,QAAOC,eAAeC,OAAO,UAAW/D","file":"mn-form.js","sourcesContent":["class MnForm extends HTMLElement {\n  constructor(self) {\n    self = super(self)\n    this.setForm()\n    return self\n  }\n\n  setForm() {\n    const attributeSpecs = [\n      {\n        name: 'spellcheck',\n        default: 'false',\n        values: [\n          'true',\n          'false',\n        ],\n      },\n      {\n        name: 'name',\n      },\n      {\n        name: 'novalidate',\n        default: 'true',\n      },\n      {\n        name: 'disabled',\n      },\n      {\n        name: 'autocapitalize',\n      },\n      {\n        name: 'id',\n        remove: true,\n      },\n    ]\n\n    const form = document.createElement('form')\n\n    form.addEventListener('submit', validate)\n\n    function validate(event) {\n      event.preventDefault()\n      console.log('submitted', form.checkValidity())\n      form.classList.add('submitted')\n    }\n\n    const attributes = Array\n      .from(this.attributes)\n      .map(getNameAndValue)\n\n    const defaultAttibutes = attributeSpecs\n      .filter(attr => attr.hasOwnProperty('default'))\n      .filter(defaultAttr => !attributes.some(attribute => attribute.name === defaultAttr.name)) // not implemented\n\n    const instanceIndex = Array.from(document.querySelectorAll('mn-form')).indexOf(this)\n    const defaultFormName = `form${instanceIndex > 0 ? instanceIndex : ''}`\n\n    form.setAttribute('name', this.getAttribute('name') || defaultFormName)\n\n    attributes.concat(defaultAttibutes).forEach(setAttribute)\n\n    attributeSpecs\n      .filter(attr => attr.remove)\n      .forEach(attr => {\n        this.removeAttribute(attr.name)\n      })\n\n    Array\n      .from(this.children)\n      .forEach(putInForm)\n\n    Array\n      .from(this.classList)\n      .forEach(cssClass => {\n        this.classList.remove(cssClass)\n        form.classList.add(cssClass)\n      })\n\n    this.removeAttribute('class')\n    this.removeAttribute('name')\n\n    function putInForm(element) {\n      form.appendChild(element)\n    }\n\n    this.insertBefore(form, this.firstChild)\n\n    function getNameAndValue(attr) {\n      const name = attr.name\n      const value = attr.value\n      return {name, value}\n    }\n\n    function setAttribute(attribute) {\n      const attributeSpec = attributeSpecs.filter(spec => spec.name === attribute.name)[0]\n      if (!attributeSpec) {\n        return false\n      }\n      const isDefaultAttribute = attributeSpec.hasOwnProperty('default')\n      const attributeValue = attribute.value\n\n      if (isDefaultAttribute) {\n        const isValidValue = attributeSpec.hasOwnProperty('values')\n          && attributeSpec.values.indexOf(attributeValue) >= 0\n\n        const value = isValidValue\n          ? attributeValue\n          : attributeSpec.default\n\n        form.setAttribute(attribute.name, value)\n      } else if (attributeValue) {\n        form.setAttribute(attribute.name, attributeValue)\n      }\n    }\n  }\n}\n\nwindow.customElements.define('mn-form', MnForm)\n"]}